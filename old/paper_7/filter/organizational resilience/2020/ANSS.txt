item 7.management's discussion and analysis of financial condition and results of operations business ansys, a delaware corporation formed in 1994, develops and globally markets engineering simulation software and services widely used by engineers, designers, researchers and students across a broad spectrum of industries and academia, including aerospace and defense, automotive, electronics, semiconductors, energy, materials and chemical processing, turbomachinery, consumer products, healthcare, and sports. headquartered south of pittsburgh, pennsylvania, we employed approximately 4,800 people as of december 31, 2020. we focus on the development of open and flexible solutions that enable users to analyze designs directly on the desktop, providing a common platform for fast, efficient and cost-conscious product development, from design concept to final-stage testing and validation. we distribute our suite of simulation technologies through direct sales offices in strategic, global locations and a global network of independent resellers and distributors (collectively, channel partners). it is our intention to continue to maintain this hybrid sales and distribution model.
our strategy of pervasive engineering simulation seeks to deepen the use of simulation in our core, to inject simulation throughout the product lifecycle and to embed simulation into our partners' ecosystems. the engineering software simulation market is strong and growing. its market growth is driven by customers' need for rapid, quality innovation in a cost efficient manner, enabling faster time to market of new products and lower warranty costs. while the transition away from physical prototyping toward simulation is prevalent through all industries, its demand is heightened by investments in high-growth solutions, including 5g, electrification, autonomous and the iiot. our strategy of pervasive engineering simulation is aligned with the market growth.
we license our technology to businesses, educational institutions and governmental agencies. growth in our revenue is affected by the strength of global economies, general business conditions, currency exchange rate fluctuations, customer budgetary constraints and the competitive position of our products. we believe that the features, functionality and integrated multiphysics capabilities of our software products are as strong as they have ever been. however, the software business is generally characterized by long sales cycles. these long sales cycles increase the difficulty of predicting sales for any particular quarter. we make many operational and strategic decisions based upon short- and long-term sales forecasts that are impacted not only by these long sales cycles, but also by current global economic conditions, including the impact of the current covid-19 pandemic. as a result, we believe that our overall performance is best measured by fiscal year results rather than by quarterly results. please see the sub-section entitled "company operational risks" under part i. item 1a. of this annual report on form 10-k for additional discussion of the potential impact of our sales forecasts on our financial condition, cash flows and operating results.
management considers the competition and price pressure that it faces in the short- and long-term by focusing on expanding the breadth, depth, ease of use and quality of the technologies, features, functionality and integrated multiphysics capabilities of our software products as compared to our competitors; investing in research and development to develop new and innovative products and increase the capabilities of our existing products; supplying new products and services; focusing on customer needs, training, consulting and support; and enhancing our distribution channels. we also consider acquisitions to supplement our global engineering talent, product offerings and distribution channels.
overview impact of covid-19
we are continuing to closely monitor the spread of covid-19 and have employed measures to mitigate its potential effects on our business as described in this annual report on form 10-k. the covid-19 pandemic has had, and is expected to continue to have, an adverse impact on our business and our employees.
the health and safety of our employees and their families, our partners and our broad ansys community around the world is a high priority. at the onset of the crisis, we took action to enable our employees to work from home. we closed our offices (including our corporate headquarters), transitioned to a remote work environment and implemented certain travel restrictions, each of which have disrupted how we operate our business. we are continuing to monitor the situation, but as of now remote access remains the primary means of work for a majority of our workforce. remote work arrangements have not adversely affected our ability to maintain effective financial operations, including our financial reporting systems, internal controls over financial reporting and disclosure controls and procedures. we expect to maintain these effective controls as we continue to work remotely during the covid-19 pandemic.
the impact from the rapidly changing market and economic conditions due to the covid-19 pandemic has disrupted the business of our customers and partners, and has impacted our business and consolidated results of operations. our current expectations regarding future performance are subject to significant uncertainty and dependent upon how widespread the virus table of contents becomes, the duration and severity of the outbreak, the geographic markets affected, the actions taken by governmental authorities to contain the spread of the virus, including the shelter-in-place orders, the nature and scope of government economic recovery measures and other factors. the spread of the virus and economic deterioration caused by the virus have had an adverse impact on our business and, in the future, could have a material adverse impact on our business, as well as on our ability to achieve our financial guidance. we continue to adjust our spending to reflect our expectations for the pace at which economic recovery will occur, while balancing the need to invest for the long-term opportunity. we have also maintained and intend to maintain our commitment to invest in our acquisitions, r&d and certain digital transformation projects, in particular our crm and human resources information system (hris) projects, as those projects are critical to our ability to operate efficiently and scale the business for future growth. during 2020, we onboarded our partner community in crm and we implemented several hris modules, including remote on-boarding. in addition, we continue to strategically invest in research and development, enabling us to stay on track with our product release targets.
please see "risk factors" under part i. item 1a. of this annual report on form 10-k for discussion on additional business risks, including those associated with the covid-19 pandemic.
overall gaap and non-gaap results this section includes a discussion of gaap and non-gaap results. for reconciliations of non-gaap results to gaap results, see the section titled "non-gaap results" herein.
operating income                              (3.6)     %                           5.3     %
we experienced an increase in revenue during the year ended december 31, 2020 due to growth in lease licenses, maintenance and service revenue and contributions from our recent acquisitions, partially offset by reductions in perpetual license revenue. the covid-19 pandemic and trade restrictions with china adversely impacted our revenue during the year ended december 31, 2020 with the most pronounced reductions occurring in perpetual licenses. however, due to our diverse customer base, both from a vertical and geographic perspective, as well as the close relationships with customers, we were able to conduct a large amount of business remotely, which partially mitigated the impacts of the covid-19 outbreak.
we also experienced increased operating expenses primarily due to increased personnel costs, higher stock-based compensation and additional operating expenses related to acquisitions. while our hiring pace was slowed and certain discretionary operational expenses, such as travel, were reduced, the covid-19 pandemic did not have a material impact on our operating expenses during the year ended december 31, 2020.
the non-gaap results exclude the income statement effects of the acquisition accounting adjustments to deferred revenue, stock-based compensation, amortization of acquired intangible assets, transaction expenses related to business combinations, and adjustments related to the transition tax associated with the tax cuts and jobs act.
impact of foreign currency our comparative financial results were impacted by fluctuations in the u.s. dollar during the year ended december 31, 2020 as compared to the year ended december 31, 2019. the net favorable impacts on our gaap and non-gaap revenue and operating income as a result of the weakened u.s. dollar when measured against our primary foreign currencies are reflected in the table below.
operating income        $11,986                             $12,211
table of contents in constant currency, our variances were as follows:
operating income        (6.0)       %                             3.5     %
constant currency amounts exclude the effects of foreign currency fluctuations on the reported results. to present this information, the 2020 results for entities whose functional currency is a currency other than the u.s. dollar were converted to u.s. dollars at rates that were in effect for the 2019 comparable period, rather than the actual exchange rates in effect for 2020. constant currency growth rates are calculated by adjusting the 2020 reported revenue and operating income amounts by the 2020 currency fluctuation impacts and comparing to the 2019 comparable period reported revenue and operating income amounts.
other key business metric annual contract value (acv) is one of our key performance metrics and is useful to investors in assessing the strength and trajectory of our business. given that revenue is variable due to the upfront revenue recognition of multi-year lease license sales, we provide acv as a supplemental metric to help evaluate the annual performance of the business. summed over the long term, acv and revenue lead to similar outcomes. however, there will be years where acv growth lags revenue growth and other years where acv growth leads revenue growth. it is used by management in financial and operational decision-making and in setting sales targets used for compensation. acv should be viewed independently of revenue and deferred revenue as acv is a performance metric and is not intended to be combined with any of these items. there is no gaap measure comparable to acv. acv is composed of the following:
•the annualized value of maintenance and lease contracts with start dates or anniversary dates during the period, plus
•the value of perpetual license contracts with start dates during the period, plus
•the annualized value of fixed-term services contracts with start dates or anniversary dates during the period, plus
•the value of work performed during the period on fixed-deliverable services contracts.
year ended december 31,   change
recurring acv as a percentage of acv                  82.0    %                           77.4    %
recurring acv is composed of both lease licenses and maintenance contracts. the increase in recurring acv reflected for the year ended december 31, 2020 has been driven by a meaningful reduction in perpetual licenses and an increased preference for lease licenses, due in part to the impacts of covid-19.
while the resilience of our business is evident in the growth shown above, the economic conditions due to the covid-19 outbreak have disrupted the business of our customers and partners, and have adversely impacted our business and consolidated results. in addition, trade discussions between the u.s. and china led to certain entities being placed on a restricted entity list. these restrictions limited our ability to deliver products and services to these customers. the 2019 operating results include approximately $20.0 million of acv related to transactions that occurred prior to the placement of the restrictions. these restrictions remained in place throughout 2020.
other financial information our financial position includes $913.2 million in cash and short-term investments, and working capital of $990.4 million as of december 31, 2020.
during the year ended december 31, 2020, we repurchased 0.7 million shares for $161.0 million at an average price of $233.48 per share under our stock repurchase program, all of which occurred during the first quarter. as of december 31, 2020, we had 2.8 million shares remaining available for repurchase under our authorized share repurchase program.
table of contents geographic trends the following table presents our geographic constant currency revenue growth during the year ended december 31, 2020 as compared to the year ended december 31, 2019:
to drive growth, we continue to focus on a number of sales improvement activities across the geographic regions, including sales hiring, pipeline building, productivity initiatives and customer engagement activities.
continued trade tensions between the u.s. and china, together with the uncertainty around the covid-19 outbreak, may further restrict our ability to sell and distribute our products to certain customers and our ability to collect against existing trade receivables and could have an adverse effect on our business, results of operations or financial condition. refer to additional details in "risk factors" under part i. item 1a. of this annual report on form 10-k industry commentary:
our three largest industries - high-tech, automotive and aerospace and defense (a&d) - remained strong throughout 2020 as companies accelerate their digital transformation initiatives. the high-tech industry was positively impacted by companies' continued investments in the development of the next generation of increasingly complex chips and technology to support the applications of 5g, autonomy and other high growth areas. the automotive industry maintained its growth through the development of electrification and autonomous technologies. while the commercial aviation sector continues to be significantly impacted by the dramatic reduction in demand for global air travel, the continued needs of national security ensure that the defense segment has remained strong and buoyed our overall performance in the aerospace and defense industry.
table of contents acquisitions we make targeted acquisitions in order to support our long-term strategic direction, accelerate innovation, provide increased capabilities to our existing products, supply new products and services, expand our customer base and enhance our distribution channels. our recent acquisitions are as follows:
date of closing                             company                purchase price                                                                                                                                                                                                                                                                                                                                      details
2020 acquisitions december 1, 2020                                agi                $722.5 million                                          agi, a premier provider of mission-simulation, modeling, testing and analysis software for aerospace, defense and intelligence applications, expands the scope of our offerings, empowering users to solve challenges by simulating from the chip level all the way to a customer's entire mission.
april 1, 2020                             lumerical                $107.5 million                                                                                              lumerical, a leading developer of photonic design and simulation tools, adds best-in-class photonic products to our multiphysics portfolio, providing customers with a full set of solutions to solve their next-generation product challenges.
2019 acquisitions november 1, 2019                                lst                $781.5 million                            lst, the premier provider of explicit dynamics and other advanced finite element analysis technology, empowers our customers to solve a new class of engineering challenges, including developing safer automobiles, aircraft and trains while reducing or even eliminating the need for costly physical testing.
november 1, 2019                            dynardo                           (1)                                                                        dynardo, a leading provider of multidisciplinary analysis and optimization technology, gives our customers access to a full suite of process integration and robust design tools - empowering users to identify optimal product designs faster and more economically.
may 1, 2019                           dfr solutions                           (1)                                                                                                   dfr solutions' electronics reliability technology, combined with our existing comprehensive multiphysics portfolio, gives our customers a complete designer-level solution to analyze for electronics failure earlier in the design cycle.
february 4, 2019                              helic                           (1)                                    helic, the industry-leading provider of electromagnetic crosstalk solutions for systems on chips, combined with our flagship electromagnetic and semiconductor solvers, provides a comprehensive solution for on-chip, 3d integrated circuit and chip-package-system electromagnetics and noise analysis.
february 1, 2019                      granta design                $208.7 million                                                                                                       granta design, the premier provider of materials information technology, expands our portfolio into this important area, giving customers access to materials intelligence, including data that is critical to successful simulations.
2018 acquisition may 2, 2018                                   optis                $291.0 million                optis, a premier provider of software for scientific simulation of light, human vision and physics-based visualization, extends our portfolio into the area of optical simulation to provide comprehensive sensor solutions, covering visible and infrared light, electromagnetics and acoustics for camera, radar and lidar.
(1) the combined purchase price of these acquisitions was $138.5 million, each of which was individually insignificant.
for further information on our business combinations during the years ended december 31, 2020, 2019 and 2018, see note 4 to the consolidated financial statements included in part iv, item 15 of this annual report on form 10-k.
table of contents results of operations for purposes of the following discussion and analysis, the table below sets forth certain consolidated financial data for the years 2020, 2019 and 2018. the operating results of our acquisitions have been included in the results of operations since their respective acquisition dates.
software licenses                                     $780,850                      $699,630                      $576,717
maintenance and service                                900,447                       816,262                       716,919
cost of sales:
software licenses                                       30,618                        23,944                        18,619
maintenance and service                                154,004                       120,619                       110,232
total cost of sales                                    225,264                       166,273                       155,885
gross profit                                         1,456,033                     1,349,619                     1,137,751
operating expenses:
research and development                               355,371                       298,210                       233,802
total operating expenses                               959,677                       834,579                       661,177
operating income                                       496,356                       515,040                       476,574
table of contents year ended december 31, 2020 compared to year ended december 31, 2019
year ended december 31,   change
recurring acv as a percentage of acv                  82.0    %                           77.4    %
year ended december 31,                                                                       change
software licenses                               780,850                             699,630             81,220                    11.6                          10.1
maintenance                                     840,597                             760,574             80,023                    10.5                           9.8
service                                          59,850                              55,688              4,162                     7.5                           6.8
maintenance and service                         900,447                             816,262             84,185                    10.3                           9.6
our revenue in the year ended december 31, 2020 increased 10.9% as compared to the year ended december 31, 2019, while revenue grew 9.8% in constant currency. the growth rate was favorably impacted by our continued investments in our global sales, support and marketing organizations, the timing and duration of our multi-year lease contracts, and our 2020 and 2019 acquisitions product sales contributed incremental revenue of $84.9 million. the growth rate was negatively impacted by the trade restrictions between the united states and china, and the impact of covid-19. lease license revenue increased 23.2%, or 21.3% in constant currency, as compared to the year ended december 31, 2019. annual maintenance contracts that were sold with new perpetual licenses, maintenance contracts for new perpetual licenses sold in previous years and the maintenance portion of lease license contracts collectively contributed to maintenance revenue growth of 10.5%, or 9.8% in constant currency. service revenue, driven primarily by a focus on service offerings that provide mentorship on simulation best practices, training and expanding simulation adoption, increased 7.5%, or 6.8% in constant currency, as compared to the year ended december 31, 2019. perpetual license revenue, which is derived primarily from new sales during the year ended december 31, 2020, decreased 4.4%, or 5.4% in constant currency, as compared to the year ended december 31, 2019.
we continue to experience increased interest by some of our larger customers in enterprise agreements that often include longer-term, time-based licenses involving a larger number of our software products. while these arrangements typically involve a higher overall transaction price, the upfront recognition of license revenue related to these larger, multi-year transactions can result in significantly higher lease license revenue volatility. software products, across a large variety of applications and industries, are increasingly distributed in software-as-a-service, cloud and other subscription environments in which the licensing approach is time-based rather than perpetual, resulting in shifting preferences from perpetual licenses to time-based licenses across a broader spectrum of our customers. this dynamic was elevated in 2020 as a result of the economic impacts of covid-19, and we expect it to continue into the foreseeable future.
in relation to covid-19 and our revenue, we currently expect a recovery in the business environment as reliable vaccines become more readily available. globally, businesses have not resumed full operations and our teams and those of our customers will likely continue working remotely into 2021. as a result of social distancing, our in-person demand generation events and those of our channel partners have been canceled. while we have adjusted to have a stronger digital focus, as evidenced by our hosting of our annual sales conference virtually in january, the absence of certain events has had and is expected to continue to have an adverse impact on our results, especially for certain channel partners. in addition, we have experienced delays in the timing of closing certain transactions, including large enterprise-type deals. these deals are often multi-year leases which have a significant impact on our operating results due to up-front revenue recognition of the license. we expect this trend to continue and anticipate that customers will delay certain purchases, reduce the size of planned purchases or forgo purchases that otherwise were expected to occur. additional waves or mutated variants of covid-19 could result in renewed shutdowns that stop or regress economic recovery.
table of contents with respect to revenue, on average for the year ended december 31, 2020, the u.s. dollar was approximately 2.4% weaker, when measured against our primary foreign currencies, than for the year ended december 31, 2019. the table below presents the impacts of currency fluctuations on revenue for the year ended december 31, 2020. amounts in brackets indicate a net adverse impact from currency fluctuations.
the impacts from currency fluctuations resulted in increased operating income of $12.0 million for the year ended december 31, 2020 as compared to the year ended december 31, 2019.
as a percentage of revenue, our international and domestic revenues, and our direct and indirect revenues, were as follows:
in valuing deferred revenue on the balance sheets of our recent acquisitions as of their respective acquisition dates, we applied the fair value provisions applicable to the accounting for business combinations, resulting in a reduction of deferred revenue as compared to the historical carrying amount. as a result, our post-acquisition revenue will be less than the sum of what would have otherwise been reported by us and each acquiree absent the acquisitions. the impacts on reported revenue were $14.2 million and $12.5 million for the years ended december 31, 2020 and 2019, respectively. the expected impacts on reported revenue are $9.0 million and $19.5 million for the quarter ending march 31, 2021 and the year ending december 31, 2021, respectively.
table of contents cost of sales and operating expenses:
the tables below reflect our operating results as presented on the consolidated statements of income, which are inclusive of foreign currency translation impacts. amounts included in the discussions that follow each table are provided in constant currency and are inclusive of costs related to our acquisitions. the impact of foreign exchange translation is discussed separately, where material. the 2020 and 2019 acquisitions contributed $57.9 million to the overall increase in cost of sales and operating expenses, inclusive of intangible asset amortization, with the most significant contribution from lst (acquired november 1, 2019) of $37.9 million.
2020                                                                                                                            2019                                              change
(in thousands, except percentages)                    amount                       % of                           amount                       % of                      amount                 %
revenue                                                     revenue cost of sales:
software licenses                               $30,618                        1.8                          $23,944                        1.6                      $6,674                27.9
maintenance and service                         154,004                        9.2                          120,619                        8.0                      33,385                27.7
total cost of sales                             225,264                       13.4                          166,273                       11.0                      58,991                35.5
gross profit                                 $1,456,033                       86.6                       $1,349,619                       89.0                    $106,414                 7.9
software licenses: the increase in the cost of software licenses was due to increased third-party royalties of $7.1 million.
amortization: the increase in amortization expense was due to the amortization of newly acquired intangible assets.
maintenance and service: the net increase in maintenance and service costs was primarily due to the following:
•increased salaries and other headcount-related costs of $15.8 million.
•increased third-party technical support of $7.1 million.
•increased stock-based compensation of $5.1 million.
•increased consulting costs of $2.7 million.
•increased it maintenance and software hosting costs of $1.5 million.
•increased costs related to foreign exchange translation of $1.1 million due to a weaker u.s. dollar.
•decreased business travel of $2.2 million due to covid-19.
the improvement in gross profit was a result of the increase in revenue, partially offset by the increase in the related cost of sales.
table of contents year ended december 31,
2020                                                                                                                        2019                                              change
(in thousands, except percentages)                  amount                       % of                         amount                       % of                      amount                 %
revenue                                                   revenue operating expenses:
research and development                      355,371                       21.1                        298,210                       19.7                      57,161                19.2
total operating expenses                     $959,677                       57.1                       $834,579                       55.1                    $125,098                15.0
•increased salaries, incentive compensation and other headcount-related costs of $40.3 million.
•increased stock-based compensation of $12.9 million.
•increased third-party commissions of $8.4 million.
•increased it maintenance and software hosting costs of $5.2 million.
•increased bad debt expense of $3.5 million due to expected losses related to covid-19.
•increased marketing expenses of $3.0 million.
•increased costs related to foreign exchange translation of $2.8 million due to a weaker u.s. dollar.
•decreased business travel of $16.0 million due to covid-19.
we anticipate that we will continue to make targeted investments in our global sales and marketing organizations and our global business infrastructure to enhance and support our revenue-generating activities.
research and development: the increase in research and development costs was primarily due to the following:
•increased salaries and other headcount-related costs of $38.0 million.
•increased stock-based compensation of $11.4 million.
•increased it maintenance and software hosting costs of $4.4 million.
we have traditionally invested significant resources in research and development activities and intend to continue to make investments in expanding the ease of use and capabilities of our broad portfolio of simulation software products, even with the on-going covid-19 pandemic.
interest income: interest income for the year ended december 31, 2020 was $5.1 million as compared to $12.8 million for the year ended december 31, 2019. interest income decreased as a result of a lower interest rate environment and the related decrease in the average rate of return on invested cash balances.
interest expense: interest expense for the year ended december 31, 2020 was $11.0 million as compared to $3.5 million for the year ended december 31, 2019. interest expense increased as a result of the interest incurred on debt financing obtained in connection with the acquisitions of agi and lst in the fourth quarters of 2020 and 2019, respectively.
other income (expense), net: our other income (expense) consisted of the following:
table of contents income tax provision: our income before income tax provision, income tax provision and effective tax rate were as follows:
the decrease in the effective tax rate from the prior year was primarily due to tax benefits of $7.5 million related to entity structuring activities and increased benefits from research and development credits of $4.1 million. these benefits were partially offset by decreased benefits of $6.1 million in the foreign-derived intangible income (fdii) deduction and the decrease in releases of valuation allowance of $2.6 million.
when compared to the federal and state combined statutory rate for each respective period, the effective tax rates for the years ended december 31, 2020 and 2019 were also favorably impacted by tax benefits from stock-based compensation, the fdii deduction, and research and development credits.
table of contents year ended december 31, 2019 compared to year ended december 31, 2018
year ended december 31,   change
recurring acv as a percentage of acv                  77.4    %                           76.9    %
year ended december 31,                                                                       change
software licenses                               699,630                             576,717            122,913                    21.3                          23.1
maintenance                                     760,574                             676,883             83,691                    12.4                          14.3
service                                          55,688                              40,036             15,652                    39.1                          41.5
maintenance and service                         816,262                             716,919             99,343                    13.9                          15.8
our revenue in the year ended december 31, 2019 increased 17.2% as compared to the year ended december 31, 2018, or 19.0% in constant currency. the growth rate was favorably impacted by our continued investments in our global sales, support and marketing organizations, as well as our 2019 and 2018 acquisitions which contributed incremental revenue of $72.9 million. lease license revenue increased 47.3%, or 49.4% in constant currency, as compared to the year ended december 31, 2018, driven primarily by an increase in multi-year lease contracts. annual maintenance contracts that were sold with new perpetual licenses, maintenance contracts for new perpetual licenses sold in previous years and the maintenance portion of lease license contracts each contributed to maintenance revenue growth of 12.4%, or 14.3% in constant currency. service revenue, driven primarily by a focus on service offerings that provide on-site mentorship on simulation best practices, training and expanding simulation adoption, increased 39.1%, or 41.5% in constant currency, as compared to the year ended december 31, 2018. perpetual license revenue, which is derived primarily from new sales during the year ended december 31, 2019, decreased 2.5%, or 1.1% in constant currency, as compared to the year ended december 31, 2018.
table of contents with respect to revenue, on average for the year ended december 31, 2019, the u.s. dollar was approximately 3.3% stronger, when measured against our primary foreign currencies, than for the year ended december 31, 2018. the table below presents the impacts of currency fluctuations on revenue for the year ended december 31, 2019. amounts in brackets indicate an adverse impact from currency fluctuations.
the impacts from currency fluctuations resulted in decreased operating income of $10.2 million for the year ended december 31, 2019 as compared to the year ended december 31, 2018.
as a percentage of revenue, our international and domestic revenues, and our direct and indirect revenues, were as follows:
in valuing deferred revenue on the balance sheets of our recent acquisitions as of their respective acquisition dates, we applied the fair value provisions applicable to the accounting for business combinations, resulting in a reduction of deferred revenue as compared to the historical carrying amount. as a result, our post-acquisition revenue will be less than the sum of what would have otherwise been reported by us and each acquiree absent the acquisitions. the impacts on reported revenue were $12.5 million and $9.4 million for the years ended december 31, 2019 and 2018, respectively.
table of contents cost of sales and operating expenses:
the tables below reflect our operating results as presented on the consolidated statements of income, which are inclusive of foreign currency translation impacts. amounts included in the discussions that follow each table are provided in constant currency and are inclusive of costs related to our acquisitions. the impact of foreign exchange translation is discussed separately, where material. the 2019 and 2018 acquisitions contributed $54.7 million to the overall increase in cost of sales and operating expenses with the most significant contributions from the optis (may 2, 2018) and granta design (february 1, 2019) acquisitions of $17.3 million and $18.9 million, respectively.
2019                                                                                                                            2018                                              change
(in thousands, except percentages)                    amount                       % of                           amount                       % of                      amount                       %
revenue                                                     revenue cost of sales:
software licenses                               $23,944                        1.6                          $18,619                        1.4                      $5,325                      28.6
maintenance and service                         120,619                        8.0                          110,232                        8.5                      10,387                       9.4
total cost of sales                             166,273                       11.0                          155,885                       12.1                      10,388                       6.7
gross profit                                 $1,349,619                       89.0                       $1,137,751                       87.9                    $211,868                      18.6
software licenses: the increase in the cost of software licenses was primarily due to increased third-party royalties of $5.6 million.
amortization: the net decrease in amortization expense was primarily due to a decrease in the amortization of trade names and acquired technology due to assets that became fully amortized, which was partially offset by the amortization of newly acquired intangible assets.
maintenance and service: the net increase in maintenance and service costs was primarily due to the following:
•increased salaries of $4.0 million.
•increased stock-based compensation of $3.3 million.
•increased consulting costs of $1.7 million.
•increased it maintenance and software hosting costs of $1.3 million.
•decreased costs related to foreign exchange translation of $2.0 million due to a stronger u.s. dollar.
the improvement in gross profit was a result of the increase in revenue, partially offset by the increase in the related cost of sales.
table of contents year ended december 31,
2019                                                                                                                        2018                                              change
(in thousands, except percentages)                  amount                       % of                         amount                       % of                      amount                 %
revenue                                                   revenue operating expenses:
research and development                      298,210                       19.7                        233,802                       18.1                      64,408                27.5
total operating expenses                     $834,579                       55.1                       $661,177                       51.1                    $173,402                26.2
•increased salaries, incentive compensation and other headcount-related costs of $63.7 million.
•increased stock-based compensation of $13.5 million.
•increased business travel of $6.5 million.
•increased marketing expenses of $5.4 million.
•increased professional fees of $4.5 million.
•increased consulting costs of $4.2 million.
•decreased costs related to foreign exchange translation of $7.1 million due to a stronger u.s. dollar.
research and development: the increase in research and development costs was primarily due to the following:
•increased salaries, incentive compensation and other headcount-related costs of $41.1 million.
•increased stock-based compensation of $16.0 million.
interest income: interest income for the year ended december 31, 2019 was $12.8 million as compared to $11.4 million for the year ended december 31, 2018. interest income increased as a result of an increase in the average rate of return on invested cash balances.
interest expense: interest expense for the year ended december 31, 2019 was $3.5 million as compared to $0.1 million for the year ended december 31, 2018. interest expense increased as a result of the interest incurred on debt financing obtained in fiscal year 2019.
other expense, net: our other expense consisted of the following:
the decrease in the effective tax rate from the prior year was primarily due to $6.7 million of benefit related to the release of a valuation allowance in a foreign jurisdiction and $1.8 million of benefit related to transition tax recorded in 2019. these table of contents benefits are offset by $6.7 million of benefit recorded in 2018 related to global legal entity restructuring activities that did not recur in 2019.
when compared to the federal and state combined statutory rate for each respective period, the effective tax rates for the years ended december 31, 2019 and 2018 were favorably impacted by tax benefits from stock-based compensation, the foreign-derived intangible income deduction, and research and development credits.
table of contents non-gaap results we provide non-gaap revenue, non-gaap gross profit, non-gaap gross profit margin, non-gaap operating income, non-gaap operating profit margin, non-gaap net income and non-gaap diluted earnings per share as supplemental measures to gaap regarding our operational performance. these financial measures exclude the impact of certain items and, therefore, have not been calculated in accordance with gaap. a detailed explanation and a reconciliation of each non-gaap financial measure to its most comparable gaap financial measure are included below.
ansys, inc. and subsidiaries reconciliations of gaap to non-gaap measures
(in thousands, except percentages and per share data)       revenue                          gross profit                               %               operating income                            %                      net income                   eps - diluted1
amortization of intangible assets from acquisitions         -                                40,642                               2.4   %               57,241                                3.4   %                    57,241                            0.66
transaction expenses related to business combinations       -                                -                                      -   %               5,129                                 0.3   %                     5,129                            0.06
rabbi trust (income) / expense                              -                                -                                      -   %               -                                       -   %                       (6)                               -
adjustment for income tax effect                            -                                -                                      -   %               -                                       -   %                  (81,574)                          (0.93)
table of contents year ended december 31, 2019
(in thousands, except percentages and per share data)       revenue                       gross profit                          %                 operating income                  %                   net income                eps - diluted1
amortization of intangible assets from acquisitions         -                             21,710                          1.4   %                   36,879                    2.4   %                 36,879                         0.43
transaction expenses related to business combinations       -                             -                                 -   %                    6,590                    0.4   %                  6,590                         0.08
rabbi trust (income) / expense                              -                             -                                 -   %                        -                      -   %                  (369)                            -
adjustment related to the tax cuts and jobs act             -                             -                                 -   %                        -                      -   %                (1,834)                       (0.02)
adjustment for income tax effect                            -                             -                                 -   %                        -                      -   %               (61,188)                       (0.71)
(in thousands, except percentages and per share data)       revenue                       gross profit                          %                 operating income                  %                   net income                eps - diluted1
amortization of intangible assets from acquisitions         -                             27,034                          2.0   %                   40,829                    3.1   %                 40,829                         0.48
transaction expenses related to business combinations       -                             -                                 -   %                    3,526                    0.3   %                  3,526                         0.04
rabbi trust (income) / expense                              -                             -                                 -   %                        -                      -   %                     71                            -
adjustment related to the tax cuts and jobs act             -                             -                                 -   %                        -                      -   %                    895                         0.01
adjustment for income tax effect                            -                             -                                 -   %                        -                      -   %               (47,898)                       (0.56)
we use non-gaap financial measures (a) to evaluate our historical and prospective financial performance as well as our performance relative to our competitors, (b) to set internal sales targets and spending budgets, (c) to allocate resources, (d) to measure operational profitability and the accuracy of forecasting, (e) to assess financial discipline over operational expenditures and (f) as an important factor in determining variable compensation for management and employees. in addition, many financial analysts that follow us focus on and publish both historical results and future projections based on non-gaap table of contents financial measures. we believe that it is in the best interest of our investors to provide this information to analysts so that they accurately report the non-gaap financial information. moreover, investors have historically requested, and we have historically reported, these non-gaap financial measures as a means of providing consistent and comparable information with past reports of financial results.
while we believe that these non-gaap financial measures provide useful supplemental information to investors, there are limitations associated with the use of these non-gaap financial measures. these non-gaap financial measures are not prepared in accordance with gaap, are not reported by all our competitors and may not be directly comparable to similarly titled measures of our competitors due to potential differences in the exact method of calculation. we compensate for these limitations by using these non-gaap financial measures as supplements to gaap financial measures and by reviewing the reconciliations of the non-gaap financial measures to their most comparable gaap financial measures.
the adjustments to these non-gaap financial measures, and the basis for such adjustments, are outlined below:
acquisition accounting for deferred revenue. historically, we have consummated acquisitions in order to support our strategic and other business objectives. in accordance with the fair value provisions applicable to the accounting for business combinations, acquired deferred revenue is often recorded on the opening balance sheet at an amount that is lower than the historical carrying value. although this acquisition accounting requirement has no impact on our business or cash flow, it adversely impacts our reported gaap revenue in the reporting periods following an acquisition. in order to provide investors with financial information that facilitates comparison of both historical and future results, we provide non-gaap financial measures which exclude the impact of the acquisition accounting adjustment. we believe that this non-gaap financial adjustment is useful to investors because it allows investors to (a) evaluate the effectiveness of the methodology and information used by us in our financial and operational decision-making, and (b) compare our past and future reports of financial results as the revenue reduction related to acquired deferred revenue will not recur when related lease licenses and software maintenance contracts are renewed in future periods.
amortization of intangible assets from acquisitions. we incur amortization of intangible assets, included in our gaap presentation of amortization expense, related to various acquisitions we have made. we exclude these expenses for the purpose of calculating non-gaap gross profit, non-gaap gross profit margin, non-gaap operating income, non-gaap operating profit margin, non-gaap net income and non-gaap diluted earnings per share when we evaluate our continuing operational performance because these costs are fixed at the time of an acquisition, are then amortized over a period of several years after the acquisition and generally cannot be changed or influenced by us after the acquisition. accordingly, we do not consider these expenses for purposes of evaluating our performance during the applicable time period after the acquisition, and we exclude such expenses when making decisions to allocate resources. we believe that these non-gaap financial measures are useful to investors because they allow investors to (a) evaluate the effectiveness of the methodology and information used by us in our financial and operational decision-making, and (b) compare our past reports of financial results as we have historically reported these non-gaap financial measures.
stock-based compensation expense. we incur expense related to stock-based compensation included in our gaap presentation of cost of maintenance and service; research and development expense; and selling, general and administrative expense. this non-gaap adjustment also includes excess payroll tax expense related to stock-based compensation. stock-based compensation expense (benefit) incurred in connection with our deferred compensation plan held in a rabbi trust includes an offsetting benefit (charge) recorded in other income (expense). although stock-based compensation is an expense and viewed as a form of compensation, we exclude these expenses for the purpose of calculating non-gaap gross profit, non-gaap gross profit margin, non-gaap operating income, non-gaap operating profit margin, non-gaap net income and non-gaap diluted earnings per share when we evaluate our continuing operational performance. we similarly exclude income (expense) related to assets held in a rabbi trust in connection with our deferred compensation plan. specifically, we exclude stock-based compensation and income (expense) related to assets held in the deferred compensation plan rabbi trust during our annual budgeting process and our quarterly and annual assessments of our performance. the annual budgeting process is the primary mechanism whereby we allocate resources to various initiatives and operational requirements. additionally, the annual review by our board of directors during which it compares our historical business model and profitability to the planned business model and profitability for the forthcoming year excludes the impact of stock-based compensation. in evaluating the performance of our senior management and department managers, charges related to stock-based compensation are excluded from expenditure and profitability results. in fact, we record stock-based compensation expense into a stand-alone cost center for which no single operational manager is responsible or accountable. in this way, we can review, on a period-to-period basis, each manager's performance and assess financial discipline over operational expenditures without the effect of stock-based compensation. we believe that these non-gaap financial measures are useful to investors because they allow investors to (a) evaluate our operating results and the effectiveness of the methodology used by us to review our operating results, and (b) review historical comparability in our financial reporting as well as comparability with competitors' operating results.
table of contents transaction expenses related to business combinations. we incur expenses for professional services rendered in connection with business combinations, which are included in our gaap presentation of selling, general and administrative expense. these expenses are generally not tax-deductible. we exclude these acquisition-related transaction expenses, derived from announced acquisitions, for the purpose of calculating non-gaap operating income, non-gaap operating profit margin, non-gaap net income and non-gaap diluted earnings per share when we evaluate our continuing operational performance, as we generally would not have otherwise incurred these expenses in the periods presented as a part of our operations. we believe that these non-gaap financial measures are useful to investors because they allow investors to (a) evaluate our operating results and the effectiveness of the methodology used by us to review our operating results, and (b) review historical comparability in our financial reporting as well as comparability with competitors' operating results.
tax cuts and jobs act. we recorded impacts to our income tax provision related to the enactment of the tax cuts and jobs act of 2017, specifically for the transition tax related to unrepatriated cash. we exclude these impacts for the purpose of calculating non-gaap net income and non-gaap diluted earnings per share when we evaluate our continuing operational performance, as (i) the charges are not expected to recur as part of our normal operations and (ii) the charges resulted from the extremely infrequent event of major u.s. tax reform, the last such reform having occurred in 1986. we believe that these non-gaap financial measures are useful to investors because they allow investors to (a) evaluate our operating results and the effectiveness of the methodology used by us to review our operating results, and (b) review historical comparability in our financial reporting.
non-gaap tax provision. we utilize a normalized non-gaap annual effective tax rate (aetr) to calculate non-gaap measures. this methodology provides better consistency across interim reporting periods by eliminating the effects of non-recurring items and aligning the non-gaap tax rate with our expected geographic earnings mix. to project this rate, we analyzed our historic and projected non-gaap earnings mix by geography along with other factors such as our current tax structure, recurring tax credits and incentives, and expected tax positions. on an annual basis we will re-evaluate this rate for significant items that may materially affect our projections.
non-gaap financial measures are not in accordance with, or an alternative for, gaap. our non-gaap financial measures are not meant to be considered in isolation or as a substitute for comparable gaap financial measures and should be read only in conjunction with our consolidated financial statements prepared in accordance with gaap.
we have provided a reconciliation of the non-gaap financial measures to the most directly comparable gaap financial measures as listed below:
gaap reporting measure           non-gaap reporting measure revenue                          non-gaap revenue gross profit                     non-gaap gross profit gross profit margin              non-gaap gross profit margin operating income                 non-gaap operating income operating profit margin          non-gaap operating profit margin net income                       non-gaap net income diluted earnings per share       non-gaap diluted earnings per share table of contents liquidity and capital resources as of december 31,   change
working capital                                                      $990,412                          $860,340        $130,072                   15.1
cash, cash equivalents and short-term investments cash and cash equivalents consist primarily of highly liquid investments such as money market funds and deposits held at major banks. short-term investments consist primarily of deposits held by certain of our foreign subsidiaries with original maturities of three months to one year. the following table presents our foreign and domestic holdings of cash, cash equivalents and short-term investments:
as of december 31,
(in thousands, except percentages)                   2020                 % of total   2019                                    % of total domestic                                     $582,882                     63.8                     $626,433                    71.8
in general, it is our intention to permanently reinvest all earnings in excess of previously taxed amounts. substantially all of the pre-2018 earnings of our non-u.s. subsidiaries were taxed through the transition tax and post-2018 current earnings are taxed as part of global intangible low-taxed income tax expense. these taxes increase our previously taxed earnings and allow for the repatriation of the majority of our foreign earnings without any residual u.s. federal tax. while we believe that the financial reporting bases may be greater than the tax bases of investments in foreign subsidiaries for any earnings in excess of previously taxed amounts, such amounts are considered permanently reinvested. the cumulative temporary difference related to such permanently reinvested earnings is approximately $93.0 million and we would anticipate the tax effect on those earnings to be immaterial.
the amount of cash, cash equivalents and short-term investments held by foreign subsidiaries is subject to translation adjustments caused by changes in foreign currency exchange rates as of the end of each respective reporting period, the offset to which is recorded in accumulated other comprehensive loss on our consolidated balance sheet.
cash flows from operating activities year ended december 31,                                             change
net cash provided by operating activities                   $547,310                      $499,936                      $484,988           $47,374                       $14,948
net cash provided by operating activities increased during the current fiscal year due to increased net income (net of non-cash operating adjustments) of $25.8 million and increased net cash flows from operating assets and liabilities of $21.6 million. the growth in net cash provided by operating activities was impacted by strong customer receipts in the fourth quarter, including both the recovery of payments delayed from earlier in the year due to covid-19, as well as the receipt of payments that were scheduled to be received in 2021. the growth was further aided by our ability to delay certain income, employment and indirect tax payments to 2021. despite the strong cash flow, as the covid-19 crisis lengthens, we continue to experience longer-term payment requests, particularly related to larger contract commitments.
net cash provided by operating activities increased during the prior fiscal year due to increased net income (net of non-cash operating adjustments) of $107.4 million, partially offset by decreased net cash flows from operating assets and liabilities of $92.4 million.
table of contents cash flows from investing activities year ended december 31,                                                                                                         change
net cash used in investing activities decreased during the current fiscal year due primarily to decreased acquisition-related net cash outlays of $214.9 million and decreased capital expenditures of $9.6 million. we currently plan capital spending of $30.0 million to $40.0 million during fiscal year 2021 as compared to the $35.4 million that was spent in fiscal year 2020. the level of spending will depend on various factors, including the growth of the business, general economic conditions and the on going impact of covid-19.
net cash used in investing activities increased during the prior fiscal year due primarily to increased acquisition-related net cash outlays of $504.2 million and increased capital expenditures of $23.2 million.
cash flows from financing activities year ended december 31,   change
net cash provided by financing activities decreased during the current fiscal year due primarily to $500.0 million in proceeds from long-term debt incurred in fiscal year 2019 related to the lst acquisition, of which $75.0 million was repaid in 2020 prior to its maturity date, increased stock repurchases of $101.9 million, and increased restricted stock withholding taxes paid in lieu of issuing shares of $28.6 million, partially offset by $375.0 million in proceeds from long-term debt incurred in fiscal year 2020 related to the agi acquisition.
net cash provided by financing activities increased during the prior fiscal year due primarily to $500.0 million in proceeds from long-term debt incurred in fiscal year 2019 related to the lst acquisition and decreased stock repurchases of $210.7 million, partially offset by increased restricted stock withholding taxes paid in lieu of issuing shares of $13.6 million.
table of contents other commitments - term loan facilities and operating lease obligations as of december 31, 2020, the carrying values of our term loans were $798.1 million, which is net of $1.9 million of unamortized debt issuance costs. borrowings under the term loans accrue interest at the eurodollar rate plus an applicable margin or at the base rate, at our election. the base rate is the applicable margin plus the highest of (i) the federal funds rate plus 0.500%, (ii) the bank of america prime rate and (iii) the eurodollar rate plus 1.000%. the applicable margin for these borrowings is a percentage per annum based on the lower of (1) a pricing level determined by our then-current consolidated leverage ratio and (2) a pricing level determined by our debt ratings (if such debt ratings exist). the scheduled maturities of the term loans are as follows:
we previously entered into noncancellable operating lease commitments, primarily for our domestic and international offices as well as certain operating equipment. the commitments related to these operating leases are as follows:
other cash flow information we believe that existing cash and cash equivalent balances of $912.7 million, together with cash generated from operations and access to the $500.0 million revolving credit facility, will be sufficient to meet our working capital and capital expenditure requirements through the next twelve months. our cash requirements in the future may also be financed through additional equity or debt financings. however, future disruptions in the capital markets could make financing more challenging, and there can be no assurance that such financing can be obtained on commercially reasonable terms, or at all.
we also believe that our liquidity will allow us to manage the anticipated impact of covid-19 on our business operations for the foreseeable future. however, our 2020 operating cash flow benefited from cash receipts from customer payments originally scheduled to be paid in fy 2021, as well as customer receipts from december transactions that would have traditionally been paid in the following fiscal year. these activities collectively increased our fy 2020 operating cash flow and will decrease our fy 2021 operating cash flow by approximately $25.0 million. additionally, fy 2020 operating cash flow benefited from $31.0 million related to the timing of various tax payments, $14.0 million of which will be due in 2021, resulting in a further shifting of operating cash flow between these two periods.
under our stock repurchase program, we repurchased shares as follows:
number of shares repurchased                         690                         330                         1,674
table of contents all of the shares of common stock repurchased during the year ended december 31, 2020 were repurchased in the first quarter. as of december 31, 2020, 2.8 million shares remained available for repurchase under the program.
the authorized repurchase program does not have an expiration date, and the pace of the repurchase activity will depend on factors such as working capital needs, cash requirements for acquisitions, our stock price, and economic and market conditions. our stock repurchases may be effected from time to time through open market purchases or pursuant to a rule 10b5-1 plan.
we continue to generate positive cash flows from operating activities and believe that the best uses of our excess cash are to invest in the business; acquire or make investments in complementary companies, products, services and technologies; and make payments on our outstanding debt balances. any future acquisitions may be funded by available cash and investments, cash generated from operations, debt financing, or the issuance of additional securities. additionally, we have in the past, and expect in the future, to repurchase stock in order to both offset dilution and return capital, in excess of our requirements, to stockholders with the goal of increasing stockholder value.
off-balance-sheet arrangements we do not have any special-purpose entities or off-balance-sheet arrangements.
table of contents contractual obligations our significant contractual obligations as of december 31, 2020 are summarized below:
global headquarters operating lease(2)                                                           40,735                      4,464                         8,928                        9,130                  18,213
other operating leases(3)                                                                       120,588                     22,847                        37,306                       28,210                  32,225
(1)interest on the long-term debt is estimated using the interest rate as of december 31, 2020, as the interest rate is variable. for additional information, see note 10 to the consolidated financial statements included in part iv, item 15 of this annual report on form 10-k.
(2)we previously entered into a lease agreement for 186,000 square feet of rentable space located in an office facility in canonsburg, pennsylvania, which serves as our headquarters. the term of the lease is 183 months, beginning on october 1, 2014 and expiring on december 31, 2029. we have a one-time right to terminate the lease on december 31, 2025 by providing the landlord with at least 18 months' prior written notice of such termination.
(3)other operating leases primarily include noncancellable lease commitments for our other domestic and international offices as well as certain operating equipment.
(4)unconditional purchase obligations primarily include royalties and software licenses and services, which are unrecorded as of december 31, 2020.
(5)we have $31.2 million of unrecognized tax benefits, including estimated interest and penalties, that have been recorded as liabilities in accordance with income tax accounting guidance for which we are uncertain as to if or when such amounts may be settled. as a result, such amounts are excluded from the table above.
(6)other long-term obligations primarily include third-party commissions and technical support of $42.3 million; post-employment benefits, including pension obligations, of $13.9 million for certain foreign locations; deferred employment taxes of $6.9 million; and office space restoration of $3.4 million. these amounts include the related current portions when applicable.
table of contents critical accounting policies and estimates we believe that the following critical accounting policies affect the more significant judgments and estimates used in the preparation of our consolidated financial statements.
revenue recognition: our revenue is derived principally from the licensing of computer software products and from related maintenance contracts. we enter into contracts that include combinations of products, maintenance and services, which are accounted for as separate performance obligations with differing revenue recognition patterns.
revenue from perpetual licenses is classified as software license revenue. software license revenue is recognized up front upon delivery of the licensed product and/or the utility that enables the customer to access authorization keys, provided that an enforceable contract has been received. typically, our perpetual licenses are sold with post-contract support (pcs), which includes unspecified technical enhancements and customer support. we allocate value in bundled perpetual and pcs arrangements based on the standalone selling prices of the perpetual license and pcs. revenue from pcs is classified as maintenance revenue and is recognized ratably over the term of the contract, as we satisfy the pcs performance obligation over time.
in addition to perpetual licenses, we sell time-based lease licenses. lease licenses are sold only as a bundled arrangement that includes the rights to a term software license and pcs. utilizing observable inputs, we determined that 50% of the estimated standalone selling price of the lease license is attributable to the term license and 50% is attributable to the pcs. this determination considered the value relationship for our products between pcs and time-based lease licenses, the value relationship between pcs and perpetual licenses, the average economic life of our products, software renewal rates and the price of the bundled arrangement in relation to the perpetual licensing approach. consistent with the perpetual sales, the license component is classified as software license revenue and recognized as revenue up front at the commencement of the lease upon delivery of the licensed product and/or utility that enables the customer to access authorization keys. the pcs is classified as maintenance revenue and is recognized ratably over the term of the contract, as we satisfy the pcs performance obligation over time.
revenue from training, support and other services is recognized as the services are performed. for contracts in which the service consists of a single performance obligation, such as providing a training class to a customer, we recognize revenue upon completion of the performance obligation. for service contracts that are longer in duration and often include multiple performance obligations (for example, both training and consulting), we measure the progress toward completion of the obligations and recognize revenue accordingly. in measuring progress towards the completion of performance obligations, we typically utilize output-based estimates for services with contractual billing arrangements that are not based on time and materials, and estimate output based on the total tasks completed as compared to the total tasks required for each work contract. input-based estimates are utilized for services that involve general consultations with contractual billing arrangements based on time and materials, utilizing direct labor as the input measure. proceeds from customers for the purpose of expediting roadmap items, developing new products or creating specific features and functionality for existing products are classified as revenue.
we also execute arrangements through independent channel partners in which the channel partners are authorized to market and distribute our software products to end users of our products and services in specified territories. in sales facilitated by channel partners, the channel partner bears the risk of collection from the end-user customer. we recognize revenue from transactions with channel partners in a manner consistent with the direct sales described above for both perpetual and time-based licenses. revenue from channel partner transactions is the amount remitted to us by the channel partners. this amount includes a fee for pcs that is compensation for providing technical enhancements and the second level of technical support to the end user, which is recognized over the period that pcs is to be provided.
non-income related taxes collected from customers and remitted to governmental authorities are recorded on the consolidated balance sheet as accounts receivable and accrued expenses. the collection and payment of these amounts are reported on a net basis in the consolidated statements of income and do not impact reported revenues or expenses.
we do not offer right of return. we warrant to our customers that our software will perform substantially as specified in our current user manuals. we have not experienced significant claims related to software warranties beyond the scope of maintenance support, which we are already obligated to provide. the warranty is not sold, and cannot be purchased, separately. the warranty does not provide any type of additional service to the customer or performance obligation for us.
our agreements with our customers generally require us to indemnify the customer against claims that our software infringes third-party patent, copyright, trademark or other proprietary rights. such indemnification obligations are generally limited in a variety of industry-standard respects, including our right to replace an infringing product.
table of contents significant judgments our contracts with customers typically include promises to transfer licenses and services to a customer. judgment is required to determine if the promises are separate performance obligations, and if so, to allocate the transaction price to each performance obligation. we use the estimated standalone selling price method to allocate the transaction price for each performance obligation. the estimated standalone selling price is determined using all information reasonably available to us, including market conditions and other observable inputs. the corresponding revenues are recognized as the related performance obligations are satisfied.
we apply a practical expedient to expense sales commissions as incurred when the amortization period would have been one year or less. sales commissions associated with the initial year of multi-year contracts are expensed as incurred due to their immateriality. sales commissions associated with multi-year contracts beyond the initial year are subject to an employee service requirement and are expensed as incurred as they are not considered incremental costs to obtain a contract.
we are required to adjust promised amounts of consideration for the effects of the time value of money if the timing of the payments provides the customer or us with a significant financing benefit. we consider various factors in assessing whether a financing component exists, including the duration of the contract, market interest rates and the timing of payments. our contracts do not include a significant financing component requiring adjustment to the transaction price.
goodwill and other intangible assets: we test goodwill and indefinite-lived intangible assets for impairment at least annually by performing a quantitative assessment of whether the fair value of each reporting unit or asset exceeds its carrying amount. we have one reporting unit. goodwill is tested at this reporting unit level and indefinite-lived intangible assets are tested at the individual asset level. this requires us to assess and make judgments regarding a variety of factors which impact the fair value of the reporting unit or asset being tested, including business plans, anticipated future cash flows, economic projections and other market data. because there are inherent uncertainties involved in these factors, significant differences between these estimates and actual results could result in future impairment charges and could materially impact our future financial results.
during the first quarter of 2020, we completed the annual impairment test for goodwill and the indefinite-lived intangible asset and determined that these assets had not been impaired as of the test date, january 1, 2020. given the adverse economic and market conditions caused by covid-19, we considered a variety of qualitative factors to determine if an additional quantitative impairment test was required subsequent to our annual impairment test. based on a variety of factors, including the excess of the fair values over the carrying amounts in the most recent impairment test, we determined it was not more likely than not that an impairment existed as of march 31, 2020. no other events or circumstances changed during the year ended december 31, 2020 that would indicate that the fair values of our reporting unit and indefinite-lived intangible asset are below their carrying amounts.
intangible assets are recognized apart from goodwill whenever an acquired intangible asset arises from contractual or other legal rights, or whenever it is capable of being separated or divided from the acquired entity and sold, transferred, licensed, rented, or exchanged, either individually or in combination with a related contract, asset or liability. we determined the fair value of our intangible assets using various valuation techniques, including the relief-from-royalty method and the multi-period excess earnings method. these models utilize certain unobservable inputs classified as level 3 measurements as defined by asc 820, fair value measurements and disclosures. the determination of fair value requires considerable judgment and is sensitive to changes in underlying assumptions, estimates and market factors. estimating fair value requires us to make assumptions and estimates regarding our future plans, as well as industry and economic conditions. these assumptions and estimates include, but are not limited to: royalty rate, discount rate and attrition rate. the fair values of the intangible assets will be amortized over their useful lives. impairment losses are recognized if the carrying amounts of finite-lived intangible assets are both not recoverable and exceed the fair values.
income taxes: we account for income taxes under the asset and liability method, which requires the recognition of deferred tax assets and liabilities for the expected future tax consequences of events that have been included in the financial statements. under this method, deferred tax assets and liabilities are determined based on the differences between the financial statement and tax bases of assets and liabilities using enacted tax rates in effect for the year in which the differences are expected to reverse. the effect of a change in tax rates on deferred tax assets and liabilities is recognized in income in the period of the enactment date.
we record net deferred tax assets to the extent we believe these assets will more likely than not be realized. in making such determination, we consider all available positive and negative evidence, including scheduled reversals of deferred tax liabilities, projected future taxable income, tax planning strategies and recent financial operations. in the event we determine that we will be able to realize deferred tax assets for which a valuation allowance was used to reduce their carrying value, the adjustment to the valuation allowance will be recorded as a reduction to the provision for income taxes.
table of contents tax benefits related to uncertain tax positions taken or expected to be taken on a tax return are recorded when such benefits meet a more-likely-than-not threshold. otherwise, these tax benefits are recorded when a tax position has been effectively settled, which means that the statute of limitations has expired or the appropriate taxing authority has completed its examination even though the statute of limitations remains open.
we recognize interest and penalties related to income taxes within the income tax expense line in the consolidated statements of income. accrued interest and penalties are included within the related tax liability line in the consolidated balance sheets.
stock-based compensation: we grant restricted stock units and other stock awards to employees and directors under our equity incentive plan. eligible employees can also purchase shares of our common stock at a discount under our employee stock purchase plan. the benefits provided under these plans are stock-based payments subject to the provisions of stock-based payment accounting guidance. we use the fair value method to apply the provisions of stock-based payment accounting guidance. stock-based compensation expense for 2020, 2019 and 2018 was $145.6 million, $116.2 million and $83.3 million, respectively. as of december 31, 2020, total unrecognized estimated compensation expense related to awards granted prior to that date was $160.7 million, which is expected to be recognized over a weighted average period of 1.4 years.
prior to 2017, we granted stock option awards. the value of each stock option award was estimated on the date of grant, or date of acquisition for options issued in a business combination, using the black-scholes option pricing model (black-scholes model). the determination of the fair value of stock-based payment awards using an option pricing model was affected by our stock price as well as assumptions regarding a number of complex and subjective variables. these variables included our stock volatility during the preceding six years, actual and projected employee stock option exercise behaviors, interest rate assumptions using the five-year u.s. treasury note yield on the date of grant or acquisition date, and expected dividends. the stock-based compensation expense for options was recorded ratably over the requisite service period. as of december 31, 2020, all stock options are fully vested and all expense has been recognized accordingly.
we issue various restricted stock unit awards which contain either a market condition, a performance condition, a service condition, or certain combinations of the three. restricted stock unit awards are valued based on the grant-date fair value of the award. stock-based compensation expense is recognized over the employee's requisite service period for awards with only a service condition.
awards with performance conditions are granted over three one-year sub-performance periods. stock-based compensation expense is recognized from the grant date through the end of the three-year performance period contingent upon continued employment and management's estimates concerning the probability of vesting.
at times, the compensation committee may grant long-term performance awards. stock based compensation expense for these awards is recognized over the performance period from the grant date through the end of the performance period contingent upon continued employment and management's estimates concerning the probability of vesting.
vesting of restricted stock unit awards with a market condition is based on our performance as measured by total stockholder return relative to the appreciation of a specified stock index over the measurement period, subject to each participant's continued employment through the conclusion of the measurement period. the fair value of the restricted stock unit awards with a market condition is estimated using a monte carlo simulation model. the determination of the fair value of the awards is affected by the grant date and several variables, each of which has been identified in the chart below. stock-based compensation expense based on the fair value of the award is recorded from the grant date through the conclusion of the measurement period.
risk-free interest rate                                                0.7%                          2.5%                          2.4%
expected volatility-ansys stock price                                   25%                           23%                           21%
expected volatility-nasdaq composite index                              18%                           16%                           15%
expected term                                                     2.8 years                     2.8 years                     2.8 years correlation factor                                                     0.77                          0.71                          0.65
we also grant restricted stock units to non-employee directors, which vest upon the earlier of one year from the date of grant or the date of the next regular annual meeting of stockholders. if a non-employee director retires prior to the vest date, the non-employee director receives a pro-rata portion of the restricted stock units.
table of contents to the extent we change the terms of our stock-based compensation programs, experience market volatility in the pricing of our common stock that increases the implied volatility assumption used in the pricing models, refine different assumptions, or assume stock awards from acquired companies that are different in nature than our stock award arrangements, among other potential impacts, the stock-based compensation expense recorded in future periods and the related tax benefits may differ significantly from what was recorded in previous reporting periods. forfeitures of awards are accounted for as they occur.
estimates of stock-based compensation expense are significant to our financial statements, but this expense is partially based on the aforementioned option valuation and monte carlo simulation models and will never result in the payment of cash by us other than through the payment of withholding taxes in lieu of additional share issuance. for this reason, and because we do not view stock-based compensation as related to our operational performance, the board of directors and management exclude stock-based compensation expense when evaluating our underlying business performance.
contingencies: we are involved in various investigations, claims and legal proceedings that arise in the ordinary course of business, including commercial disputes, labor and employment matters, tax audits, alleged infringement of intellectual property rights and other matters. we review the status of these matters, assess our financial exposure and record a related accrual if the potential loss from an investigation, claim or legal proceeding is probable and the amount is reasonably estimable. significant judgment is involved in the determination of probability and in the determination of whether an exposure is reasonably estimable. as a result of the uncertainties involved in making these estimates, we may have to revise our estimates as facts and circumstances change. the revision of these estimates could have a material impact on our financial position and results of operations.
recent accounting guidance for information regarding recent accounting guidance and its impact on our consolidated financial statements, see note 2 to the consolidated financial statements in part iv, item 15 of this annual report on form 10-k.